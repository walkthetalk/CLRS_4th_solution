\startEXERCISE\DIFFICULT
給定一個含 $n$ 個數的序列，
設計一個時間復雜度爲 $O(n\lg n)$ 的算法，
求其最長單調遞增子序列。
（\emph{提示：}一個長度爲 $i$ 的候選子序列的尾元素
至少不比長度爲 $i-1$ 候選子序列的尾元素小。
因此，可以在輸入序列中將候選子序列鏈接起來。）
\stopEXERCISE

\startANSWER
參考 \simpleurl{http://www.csie.ntu.edu.tw/~kmchao/seq06fall/dp.pdf} 中 2.2 節。
要想使序列儘量長，則需讓序列中的值增大的儘量慢，也就是說序列變長時，讓尾部的數儘量小。

\CLRSH{LIS_LENGTH(X)}
\startCLRSCODE
// 所有長度爲 $k$ 的子序列中最小的尾元素，單調遞增
\ALGO{NEW-ARRAY(T[1:X.len])}
len = 1
T[1] = X[1]
for i = 2 to X.len
	if X[i] > T[len]
		len = len + 1
		T[len] = X[i]
	else
		// 查找大於 X[i] 的最小元素的位置
		pos = \ALGO{BI-SEARCH(T, len, X[i])}
		T[pos] = X[i]
return len
\stopCLRSCODE
\stopANSWER
