\startEXERCISE\DIFFICULT
證明： 在所有元素都不同的情況下， \ALGO{HEAPSORT} 的時間復雜度爲 $\Omega(n\lg{n})$。
\stopEXERCISE

\startANSWER
假設堆是完全二叉樹，元素個數爲 $n=2^k - 1$。
有 $2^{k-1}$ 個葉子節點以及 $2^{k-1} - 1$ 個內部節點。

先來看爲堆中前 $2^{k-1}$ 個元素排序。
給葉子節點着紅色，內部節點着藍色。
已着色的節點是堆的子樹。
由於有 $2^{k-1}$ 個節點已着色，
紅色的最多有 $2^{k-2}$ 個，
藍色的最少 $2^{k-2}-1$ 個。

紅色節點可以直接跳到根節點位置上，而藍色節點則需要先上移。
讓我們統計以下要將藍色節點移到根節點位置上，需要交換多少次。
交換次數最少的情況必須滿足兩點，
有 $2^{k-2} -1$ 個藍色節點，
且他們在樹中的相對位置已經滿足最大堆的要求。
如果有 $d$ 個這樣的藍色節點，則有 $i=\lg{d}$ 層，
第 $i$ 層含有 $2^i$ 個節點。
因此交換次數爲：
\startformula
\sum_{i=0}^{\lg{d}}i2^i = 2 + (\lg{d} - 2)2^{\lg{d}} = \Omega(d\lg{d})
\stopformula

遞迴式：
\startformula
T(n) = T(n/2) + \Omega(n\lg{n})
\stopformula

由主定理可得 $T(n)=\Omega(n\lg{n})$。
\stopANSWER
